CREATE OR REPLACE VIEW elex_results as
       SELECT n.delegates_count as us_delegates_count,
           n.superdelegates_count as us_superdelegates_count,
           d.delegates_count,
           d.superdelegates_count,
           o.*,
           c.*,
           r.*
           FROM results as r
               LEFT JOIN override_candidates as c on r.candidateid = c.candidate_candidateid
               LEFT JOIN override_races as o on r.raceid = o.race_raceid
               LEFT JOIN delegates as d on r.statepostal = d.state AND r.polid = d.candidateid
               LEFT JOIN delegates as n on r.polid = n.candidateid AND n.state = 'US'
;
